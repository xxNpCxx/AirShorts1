# üé≠ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —Å—Ü–µ–Ω

## üìã –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### 1. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é**
- ‚úÖ **–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é** (`üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é`, `–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é`) **–í–°–ï–ì–î–ê** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ `BotUpdate`
- ‚úÖ **–°—Ü–µ–Ω—ã –ù–ï –¥–æ–ª–∂–Ω—ã** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ
- ‚úÖ **BotUpdate –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ** –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ –ª—é–±–æ–π —Å—Ü–µ–Ω—ã –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é

### 2. **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—Ü–µ–Ω**

#### **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞—Å–ª–µ–¥—É–π—Ç–µ—Å—å –æ—Ç `BaseScene`:**
```typescript
import { BaseScene } from './base-scene';

@Scene('your-scene-name')
export class YourScene extends BaseScene {
  // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ —Å—Ü–µ–Ω—ã
}
```

#### **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π:**
```typescript
@On('text')
async onText(@Ctx() ctx: Context) {
  const text = (ctx.message as any).text;
  
  // 1. –õ–æ–≥–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
  this.logMainMenuMessage(text);
  
  // 2. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–æ–º–∞–Ω–¥—ã –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å—Ü–µ–Ω—ã
  if (await this.handleExitCommand(ctx, text)) {
    return; // –ö–æ–º–∞–Ω–¥–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞, –≤—ã—Ö–æ–¥–∏–º
  }
  
  // 3. –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
  // ...
}
```

### 3. **–î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç–æ–¥—ã BaseScene**

#### **`isExitCommand(text: string): boolean`**
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–æ–π –≤—ã—Ö–æ–¥–∞:
- `/start`
- `–ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é`

#### **`handleExitCommand(ctx: Context, text: string): Promise<boolean>`**
–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å—Ü–µ–Ω—ã:
- –í—ã—Ö–æ–¥–∏—Ç –∏–∑ —Å—Ü–µ–Ω—ã
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ "üè† –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é..."
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `true` –µ—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –±—ã–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞

#### **`isMainMenuMessage(text: string): boolean`**
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –≥–ª–∞–≤–Ω—ã–º –º–µ–Ω—é:
- `üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é`
- `–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é`

#### **`logMainMenuMessage(text: string): void`**
–õ–æ–≥–∏—Ä—É–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)

## üöÄ –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π —Å—Ü–µ–Ω—ã

```typescript
import { Ctx, Scene, SceneEnter, On } from 'nestjs-telegraf';
import { Context } from 'telegraf';
import { BaseScene } from './base-scene';

@Scene('example-scene')
export class ExampleScene extends BaseScene {
  
  @SceneEnter()
  async onSceneEnter(@Ctx() ctx: Context) {
    await ctx.reply('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø—Ä–∏–º–µ—Ä —Å—Ü–µ–Ω—ã!');
  }

  @On('text')
  async onText(@Ctx() ctx: Context) {
    const text = (ctx.message as any).text;
    
    // –õ–æ–≥–∏—Ä—É–µ–º –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ BotUpdate)
    this.logMainMenuMessage(text);
    
    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–æ–º–∞–Ω–¥—ã –≤—ã—Ö–æ–¥–∞
    if (await this.handleExitCommand(ctx, text)) {
      return;
    }
    
    // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞
    if (text === '–ü—Ä–∏–≤–µ—Ç') {
      await ctx.reply('–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?');
    } else {
      await ctx.reply('–ù–µ –ø–æ–Ω–∏–º–∞—é, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ "–ü—Ä–∏–≤–µ—Ç"');
    }
  }
}
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

### **–ù–ï –î–ï–õ–ê–ô–¢–ï:**
- ‚ùå –ù–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –≤ —Å—Ü–µ–Ω–∞—Ö
- ‚ùå –ù–µ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —Å—Ü–µ–Ω—ã –±–µ–∑ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –æ—Ç `BaseScene`
- ‚ùå –ù–µ –¥—É–±–ª–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏–∫—É –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å—Ü–µ–Ω—ã

### **–î–ï–õ–ê–ô–¢–ï:**
- ‚úÖ –ù–∞—Å–ª–µ–¥—É–π—Ç–µ—Å—å –æ—Ç `BaseScene`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `handleExitCommand()` –¥–ª—è –≤—ã—Ö–æ–¥–∞
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `logMainMenuMessage()` –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- ‚úÖ –°–ª–µ–¥—É–π—Ç–µ –µ–¥–∏–Ω–æ–º—É –ø–∞—Ç—Ç–µ—Ä–Ω—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

## üîß –û—Ç–ª–∞–¥–∫–∞

### **–õ–æ–≥–∏ –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ:**
```
[@On text] –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é: "üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é" - –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ô –≤—ã—Ö–æ–¥ –∏–∑ —Å—Ü–µ–Ω—ã
[@On text] –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Å—Ü–µ–Ω—ã: "your-scene-name"
[MainMenuHandler] ‚úÖ –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —É—Å–ø–µ—à–Ω–æ –ø–æ–∫–∞–∑–∞–Ω–æ
```

### **–õ–æ–≥–∏ –≤ —Å—Ü–µ–Ω–µ:**
```
[YourScene] ‚ÑπÔ∏è –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é: "üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é" - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ BotUpdate
[YourScene] üö™ –í—ã—Ö–æ–¥–∏–º –∏–∑ —Å—Ü–µ–Ω—ã –ø–æ –∫–æ–º–∞–Ω–¥–µ: "/start"
```

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ** –≤—Å–µ—Ö —Å—Ü–µ–Ω
- **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É** –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é
- **–ü—Ä–æ—Å—Ç–æ—Ç—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏** –Ω–æ–≤—ã—Ö —Å—Ü–µ–Ω
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
